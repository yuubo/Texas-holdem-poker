# Texas Hold'em Poker（德州扑克 - Netty网络版）

本项目是一个基于Netty框架开发的德州扑克（Texas Hold'em Poker）游戏，采用Spring Boot架构，支持多玩家在局域网环境下进行实时对战。游戏采用控制台界面进行操作，可以部署到idea、eclipse中，闲暇时与同事娱乐消遣。
## 🎯 项目特色

- **现代化架构**：基于Spring Boot + Netty构建，代码结构清晰
- **自动发现**：客户端可自动搜索局域网内的服务器
- **面向对象设计**：模块化设计，易于扩展和维护
- **完整规则实现**：严格遵循德州扑克标准规则

## 🏗️ 项目架构

```
Texas-holdem-poker/
├── common/          # 公共模块
│   ├── constant/    # 常量定义
│   ├── enume/       # 枚举类
│   ├── factory/     # 工厂模式
│   ├── handle/      # Netty处理器
│   ├── message/     # 消息传输对象
│   └── utils/       # 工具类
├── service/         # 服务端模块
│   ├── channel/     # 渠道管理
│   ├── context/     # 上下文管理
│   ├── game/        # 游戏逻辑
│   ├── handle/      # 业务处理器
│   └── utils/       # 游戏工具类
└── client/          # 客户端模块
    ├── context/     # 客户端上下文
    ├── handle/      # 客户端处理器
    ├── print/       # 控制台输出
    └── runner/      # 客户端启动器
```

## 🔧 技术栈

- **核心框架**：Spring Boot 3.5.6
- **网络通信**：Netty 4.2.9.Final
- **JSON处理**：Jackson 2.9.9.3
- **构建工具**：Maven
- **Java版本**：JDK 21+

## 🎮 游戏特性

### 核心玩法
- ✅ 标准德州扑克规则（2张底牌 + 5张公共牌）
- ✅ 完整的下注轮次（翻牌前、翻牌、转牌、河牌）
- ✅ 支持多种操作：跟注、加注、过牌、弃牌、All-in
- ✅ 自动牌型识别和胜负判定
- ✅ 盲注机制

### 网络特性
- ✅ TCP长连接保证消息可靠传输
- ✅ UDP广播实现服务器自动发现
- ✅ 支持跨网段手动配置连接
- ✅ 多玩家并发游戏支持

## 🚀 快速开始

### 环境要求
- Java 21 或更高版本
- Maven 3.6+
- 确保防火墙允许相应端口通信

### 编译项目
```bash
# 克隆项目
git clone <repository-url>
cd Texas-holdem-poker

# 编译整个项目
mvn clean install
```

### 启动服务端
```bash
# 进入服务端目录
cd service

# 启动服务端应用
mvn spring-boot:run
# 或者
java -jar target/service-1.0-SNAPSHOT.jar
```

默认配置：
- TCP端口：8081
- UDP端口：8080

### 启动客户端
```bash
# 进入客户端目录
cd client

# 启动客户端应用
mvn spring-boot:run
# 或者
java -jar target/client-1.0-SNAPSHOT.jar
```

每个玩家需要单独启动一个客户端实例。

## ⚙️ 配置说明

### 服务端配置 (`service/src/main/resources/application.yml`)
```yaml
netty:
  service:
    tcp:
      port: 8081          # TCP监听端口
    udp:
      enabled: true       # 是否启用UDP广播
      port: 8080          # UDP监听端口
  boosGroup:
    loopCount: 2          # Boss线程组数量
  eventLoop:
    type: NIO             # 事件循环类型(NIO/EPOLL)
```

### 客户端配置 (`client/src/main/resources/application.yml`)
```yaml
netty:
  client:
    udp:
      enabled: true       # 启用UDP自动搜索
      port: 8080          # 服务器UDP端口
  eventLoop:
    threadCount: 1        # 事件循环线程数
    type: NIO             # 事件循环类型
  service:
    host: 127.0.0.1       # 手动指定服务器IP
    port: 8081            # 手动指定服务器端口
```

## 🎯 游戏操作指南

### 客户端界面说明
启动客户端后，系统会显示类似以下信息：
```
-----------------------------------------------------------------------------------------------
@1:开始  @2:过牌  @3:跟注  @4:加注  @5:all-in  @6:弃牌  
-----------------------------------------------------------------------------------------------
```

### 基本操作
- **开始游戏**：输入 `1` 开始新游戏
- **过牌**：输入 `2` （当无需跟注时可选择）
- **跟注**：输入 `3` 跟注当前注额
- **加注**：输入 `4` 进行加注
- **All-in**：输入 `5` 全部筹码押上
- **弃牌**：输入 `6` 放弃当前手牌

### 游戏流程
1. 等待足够玩家加入（通常2-10人）
2. 系统自动分配大小盲注
3. 发放底牌（每人2张）
4. 进行四轮下注：
   - 翻牌前（Pre-flop）
   - 翻牌（Flop，3张公共牌）
   - 转牌（Turn，第4张公共牌）
   - 河牌（River，第5张公共牌）
5. 剩余玩家摊牌比大小
6. 胜者获得底池筹码

## 📊 牌型等级

从高到低依次为：
1. **皇家同花顺** - 同花色的10-J-Q-K-A
2. **同花顺** - 连续的同花色牌
3. **四条** - 四张相同点数的牌
4. **葫芦** - 三条+一对
5. **同花** - 五张同花色牌
6. **顺子** - 连续的五张牌
7. **三条** - 三张相同点数的牌
8. **两对** - 两个不同的对子
9. **一对** - 两张相同点数的牌
10. **高牌** - 单张最大牌

## 🔧 开发指南

### 项目模块说明

#### Common模块
包含所有共享组件：
- 消息传输对象（DTO）
- 枚举定义
- Netty处理器
- 工具类

#### Service模块
服务端核心逻辑：
- 游戏房间管理
- 玩家状态跟踪
- 牌局流程控制
- 网络连接管理

#### Client模块
客户端实现：
- 用户界面展示
- 输入处理
- 消息接收显示

### 扩展开发

#### 添加新的游戏操作
1. 在 `OperateEnum` 中添加新的操作枚举
2. 在 `OperateDispose` 中实现对应逻辑
3. 更新客户端显示逻辑

#### 自定义牌型算法
修改 `PokerUtils.java` 中的评分算法来调整牌型判断规则。

## 🐛 常见问题

### 连接问题
**Q: 客户端无法连接到服务器**
A: 检查以下几点：
- 确认服务器已启动且端口正确
- 检查防火墙设置
- 确认客户端和服务端在同一网络环境
- 尝试关闭UDP自动发现，手动配置服务器地址

**Q: UDP自动发现失败**
A: 
- 检查UDP端口是否被占用
- 确认网络支持UDP广播
- 可切换为手动配置模式

### 游戏问题
**Q: 游戏无法开始**
A: 需要至少2名玩家才能开始游戏

**Q: 牌型识别不准确**
A: 检查 `PokerUtils.java` 中的牌型计算逻辑

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

### 开发规范
- 遵循现有代码风格
- 添加必要的单元测试
- 更新相关文档
- 提交前运行完整测试

## 📄 许可证

本项目基于 MIT License 开源。

## 👥 作者

[yuubo](https://github.com/yuubo) - 项目创建者和主要维护者

---

**Enjoy the game! 🃏**